<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Plataformas Core - Claro</title>
  <link rel="icon" href="{{ url_for('static', filename='claro-logo.png') }}">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <link href="{{ url_for('static', filename='style.css') }}" rel="stylesheet">
</head>
<body>
  <div id="bg-video">
    <video autoplay muted loop>
      <source src="{{ url_for('static', filename='ruta-al-video.mp4') }}" type="video/mp4">
    </video>
  </div>
  <div class="bg-overlay"></div>

  <header class="header-premium">
    <div class="header-content-premium">
      <div class="logo-section">
        <img src="{{ url_for('static', filename='claro-logo.png') }}" alt="Claro" class="header-logo">
        <div class="logo-text">
          <span class="brand-name">Plataformas Core</span>
          <span class="brand-subtitle">Sistema Empresarial</span>
        </div>
      </div>
      <div class="header-controls">
        <div class="system-status">
          <div class="status-indicator-premium">
            <div class="status-pulse"></div>
            <span>Sistema Operativo</span>
          </div>
          <div class="system-metrics">
            <div class="metric">99.9% Disponibilidad</div>
            <div class="metric">24/7 Monitoreo</div>
          </div>
        </div>
      </div>
    </div>
  </header>

  <main class="main-content">
    <section class="hero-section">
      <div class="hero-background"></div>
      <div class="hero-content">
        <h1 class="hero-title">Centro de Operaciones</h1>
        <p class="hero-description">Plataforma inteligente para gestión empresarial especializada</p>
        <div class="hero-stats">
          <div class="stat-item">
            <span class="stat-number">{{ estadisticas.total or '---' }}</span>
            <span class="stat-label">Alarmas</span>
          </div>
          <div class="stat-item">
            <span class="stat-number">99.9%</span>
            <span class="stat-label">Disponibilidad</span>
          </div>
          <div class="stat-item">
            <span class="stat-number">24/7</span>
            <span class="stat-label">Monitoreo</span>
          </div>
        </div>
      </div>
    </section>

    <section class="services-grid">
      <div class="service-card" onclick="openChatAndSelectOption('1')">
        <div class="service-icon alarm">
          <i class="fas fa-exclamation-triangle"></i>
        </div>
        <h3>Gestión de Alarmas</h3>
        <p>Sistema inteligente para monitoreo y análisis de alarmas críticas.</p>
        <div class="service-badges">
          <span class="badge">Tiempo Real</span>
          <span class="badge">Inteligente</span>
        </div>
      </div>
      
      <div class="service-card" onclick="openChatAndSelectOption('2')">
        <div class="service-icon docs">
          <i class="fas fa-book-open"></i>
        </div>
        <h3>Base de Conocimiento</h3>
        <p>Documentación técnica centralizada con búsqueda avanzada.</p>
        <div class="service-badges">
          <span class="badge">Centralizado</span>
          <span class="badge">Búsqueda</span>
        </div>
      </div>
      
      <div class="service-card" onclick="openChatAndSelectOption('3')">
        <div class="service-icon incidents">
          <i class="fas fa-chart-line"></i>
        </div>
        <h3>Análisis de Incidentes</h3>
        <p>Monitoreo proactivo con análisis de tendencias para prevenir incidentes.</p>
        <div class="service-badges">
          <span class="badge">Preventivo</span>
          <span class="badge">Análisis</span>
        </div>
      </div>
    </section>
  </main>

  <footer class="footer-premium">
    <div class="footer-content">
      <div class="footer-left">
        <span>Sistema Core &copy; 2025 Claro Colombia</span>
        <span class="separator">|</span>
        <span>Plataforma Empresarial</span>
      </div>
      <div class="footer-right">
        <div class="security-badge">
          <i class="fas fa-shield-alt"></i>
          <span>Sistema Seguro</span>
        </div>
      </div>
    </div>
  </footer>

  <!-- Chat bubble -->
  <div class="chat-bubble-premium" id="chatBubble">
    <div class="bubble-pulse"></div>
    <i class="fas fa-comments bubble-icon"></i>
    <div class="bubble-notification" id="bubbleNotification">1</div>
  </div>

  <!-- Chat window -->
  <div class="chat-window-premium" id="chatWindow">
    <div class="chat-header-premium">
      <div class="chat-avatar">
        <div class="avatar-icon">
          <i class="fas fa-robot"></i>
        </div>
        <div class="avatar-status"></div>
      </div>
      <div class="chat-title-section">
        <h3 class="chat-title">Asistente de Alarmas</h3>
        <p class="chat-subtitle">Experto en plataformas Core</p>
      </div>
      <div class="chat-controls">
        <button class="control-btn" id="minimizeChat">
          <i class="fas fa-minus"></i>
        </button>
        <button class="control-btn" id="maximizeChat">
          <i class="fas fa-expand"></i>
        </button>
        <button class="control-btn" id="closeChat">
          <i class="fas fa-times"></i>
        </button>
      </div>
    </div>
    
    <div class="chat-messages" id="chatMessages">
      <!-- Mensajes se insertarán aquí dinámicamente -->
    </div>
    
    <div class="typing-indicator-premium" id="typingIndicator">
      <div class="typing-avatar">
        <i class="fas fa-robot"></i>
      </div>
      <div class="typing-content">
        <span class="typing-text">El asistente está escribiendo...</span>
        <div class="typing-animation">
          <div class="typing-dot"></div>
          <div class="typing-dot"></div>
        </div>
      </div>
    </div>
    
    <div class="chat-input-container-premium">
      <div class="input-wrapper">
        <button class="attachment-btn" id="attachBtn">
          <i class="fas fa-paperclip"></i>
        </button>
        <input type="text" class="chat-input-premium" id="messageInput" placeholder="Escribe tu consulta aquí..." maxlength="500">
        <button class="send-btn-premium" id="sendBtn">
          <i class="fas fa-paper-plane"></i>
        </button>
      </div>
      <div class="input-footer">
        <p class="input-help">Presiona Enter para enviar</p>
      </div>
    </div>
  </div>

  <script src="{{ url_for('static', filename='main.js') }}"></script>
  <script>
    // Función para abrir el chat y seleccionar una opción
    function openChatAndSelectOption(option) {
      openChat();
      setTimeout(() => {
        selectMainOption(option);
      }, 500);
    }
    
    // Mostrar mensaje de bienvenida cuando se abre el chat
    function showWelcomeMessage() {
      addBotMessage(`🚀 **¡Bienvenido al Sistema de Alarmas Claro!**\n\nSoy tu asistente virtual especializado en plataformas Core. ¿En qué puedo ayudarte hoy?`, {
        options: [
          { text: '🔍 Buscar alarma específica', value: '1' },
          { text: '📋 Ver catálogo completo', value: '2' },
          { text: '🚨 Mostrar alarmas críticas', value: '3' },
          { text: '📊 Estadísticas del catálogo', value: '4' },
          { text: '📚 Documentación técnica', value: '5' }
        ]
      });
      
      // Ocultar notificación después de mostrar el mensaje
      document.getElementById('bubbleNotification').style.display = 'none';
    }
    
    // Manejar selección de opción principal
    function selectMainOption(option) {
      const optionText = getOptionText(option);
      addUserMessage(optionText);
      
      setTimeout(() => {
        switch(option) {
          case '1':
            handleSearchOption();
            break;
          case '2':
            handleCatalogOption();
            break;
          case '3':
            handleCriticalAlarmsOption();
            break;
          case '4':
            handleStatsOption();
            break;
          case '5':
            handleDocumentationOption();
            break;
        }
      }, 500);
    }
    
    // Funciones de manejo de opciones (implementar según necesidad)
    function handleSearchOption() {
      showTyping();
      setTimeout(() => {
        hideTyping();
        addBotMessage(`🔍 **Búsqueda de Alarmas**\n\nPor favor, ingresa el **nombre del elemento** que quieres consultar.\n\nEjemplos: ROUTER-CORE-01, SWITCH-ACCESS-15, SERVER-DB-03`);
      }, 1500);
    }
    
    function handleCatalogOption() {
      showTyping();
      setTimeout(() => {
        hideTyping();
        addBotMessage(`📋 **Catálogo Completo de Alarmas**\n\nMostrando las alarmas más relevantes del sistema.`, {
          actions: [
            { text: '🔍 Ver detalles', action: 'view-catalog', class: 'primary' },
            { text: '📊 Filtrar por severidad', action: 'filter-severity', class: 'secondary' }
          ]
        });
      }, 1500);
    }
    
    // Funciones auxiliares
    function getOptionText(option) {
      const options = {
        '1': '🔍 Buscar alarma específica',
        '2': '📋 Ver catálogo completo',
        '3': '🚨 Mostrar alarmas críticas',
        '4': '📊 Estadísticas del catálogo',
        '5': '📚 Documentación técnica'
      };
      return options[option] || option;
    }
  </script>
</body>
</html>