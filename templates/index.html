<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#d41528" />
  <meta name="description" content="Asesor Claro - Asistente IA avanzado para plataformas Core" />
  <link rel="manifest" href="/static/manifest.json" />
  <link rel="icon" href="/static/claro-logo.png" type="image/png" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <title>Asesor Claro - IA Avanzada</title>
  <style>
    :root {
      --primary-color: #d41528;
      --secondary-color: #0d47a1;
      --accent-color: #ffab00;
      --success-color: #00c853;
      --error-color: #d50000;
      --warning-color: #ff6d00;
      --text-light: #f5f5f5;
      --text-dark: #212121;
      --bg-dark: #121212;
      --bg-darker: #0a0a0a;
      --glass-bg: rgba(18, 18, 18, 0.92);
      --glass-border: rgba(255, 255, 255, 0.1);
      --shadow-light: rgba(255, 255, 255, 0.1);
      --shadow-dark: rgba(0, 0, 0, 0.3);
      --transition-smooth: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      --transition-bounce: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Inter', sans-serif;
    }

    body {
      color: var(--text-light);
      overflow-x: hidden;
      height: 100vh;
      position: relative;
      background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 50%, #0a0a0a 100%);
      scroll-behavior: smooth;
    }

    /* Video Background con efectos mejorados */
    #bg-video {
      position: fixed;
      right: 0;
      bottom: 0;
      min-width: 100%;
      min-height: 100%;
      z-index: -2;
      object-fit: cover;
      filter: brightness(0.3) contrast(1.2);
    }

    .video-fallback {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(45deg, #0a0a0a, #1a1a1a, #0a0a0a);
      background-size: 400% 400%;
      animation: gradientShift 15s ease infinite;
      z-index: -2;
    }

    @keyframes gradientShift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    .overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(1px);
      z-index: -1;
    }

    /* Logo mejorado */
    .logo {
      position: fixed;
      top: 20px;
      left: 20px;
      width: 80px;
      height: 80px;
      z-index: 10;
      background: linear-gradient(135deg, var(--primary-color), #ff4757);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: 800;
      font-size: 24px;
      box-shadow: 0 8px 32px rgba(212, 21, 40, 0.4);
      transition: var(--transition-smooth);
      cursor: pointer;
    }

    .logo:hover {
      transform: scale(1.05) rotate(5deg);
      box-shadow: 0 12px 40px rgba(212, 21, 40, 0.6);
    }

    /* Sistema de estado mejorado */
    .system-status {
      position: fixed;
      top: 20px;
      right: 20px;
      display: flex;
      align-items: center;
      gap: 10px;
      background: var(--glass-bg);
      padding: 12px 16px;
      border-radius: 25px;
      border: 1px solid var(--glass-border);
      backdrop-filter: blur(15px);
      z-index: 10;
      box-shadow: 0 8px 32px var(--shadow-dark);
      transition: var(--transition-smooth);
    }

    .system-status:hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 40px var(--shadow-dark);
    }

    .status-indicator {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: var(--success-color);
      position: relative;
      overflow: hidden;
    }

    .status-indicator::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: var(--success-color);
      border-radius: 50%;
      animation: pulseGlow 2s infinite;
    }

    @keyframes pulseGlow {
      0% { transform: scale(1); opacity: 1; }
      50% { transform: scale(1.4); opacity: 0.3; }
      100% { transform: scale(1); opacity: 1; }
    }

    #status-text {
      font-size: 14px;
      font-weight: 500;
      letter-spacing: 0.5px;
    }

    /* Pantalla de bienvenida mejorada */
    .welcome-screen {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      text-align: center;
      z-index: 5;
      animation: fadeInScale 1s ease-out;
    }

    @keyframes fadeInScale {
      from { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
      to { opacity: 1; transform: translate(-50%, -50%) scale(1); }
    }

    .welcome-screen h1 {
      font-size: 3.5rem;
      margin-bottom: 1rem;
      background: linear-gradient(90deg, var(--primary-color), var(--accent-color), var(--primary-color));
      background-size: 200% 200%;
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      text-shadow: 0 0 20px rgba(212, 21, 40, 0.3);
      animation: titleGlow 3s ease-in-out infinite, gradientMove 4s ease-in-out infinite;
      font-weight: 800;
      letter-spacing: -1px;
    }

    @keyframes titleGlow {
      0%, 100% { filter: drop-shadow(0 0 15px rgba(212, 21, 40, 0.4)); }
      50% { filter: drop-shadow(0 0 35px rgba(212, 21, 40, 0.8)); }
    }

    @keyframes gradientMove {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }

    .welcome-screen p {
      font-size: 1.2rem;
      opacity: 0.8;
      animation: fadeInUp 2s ease-out;
      font-weight: 400;
      letter-spacing: 0.5px;
    }

    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 0.8; transform: translateY(0); }
    }

    /* Efectos de part√≠culas mejorados */
    .sparkle {
      position: absolute;
      width: 8px;
      height: 8px;
      background: radial-gradient(circle, rgba(255,255,255,0.8) 0%, rgba(255,255,255,0.2) 100%);
      border-radius: 50%;
      animation: sparkleEnhanced 4s infinite alternate;
    }

    @keyframes sparkleEnhanced {
      0% { transform: scale(0.8) rotate(0deg); opacity: 0.3; }
      50% { transform: scale(1.2) rotate(180deg); opacity: 1; }
      100% { transform: scale(0.8) rotate(360deg); opacity: 0.3; }
    }

    /* Chat Bubble mejorado */
    .chat-bubble {
      position: fixed;
      bottom: 30px;
      right: 30px;
      width: 65px;
      height: 65px;
      background: linear-gradient(135deg, var(--primary-color), #ff4757);
      border-radius: 50%;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 26px;
      cursor: pointer;
      box-shadow: 0 8px 32px rgba(212, 21, 40, 0.4);
      z-index: 101;
      transition: var(--transition-bounce);
      animation: floatImproved 3s ease-in-out infinite;
      border: 3px solid rgba(255, 255, 255, 0.1);
    }

    .chat-bubble:hover {
      transform: scale(1.1) rotate(5deg);
      box-shadow: 0 12px 40px rgba(212, 21, 40, 0.6);
    }

    .chat-bubble:active {
      transform: scale(0.95);
    }

    @keyframes floatImproved {
      0%, 100% { transform: translateY(0px) rotate(0deg); }
      50% { transform: translateY(-10px) rotate(2deg); }
    }

    /* Chat Container mejorado */
    .chat-container {
      position: fixed;
      bottom: 30px;
      right: 30px;
      width: 380px;
      height: 520px;
      background: var(--glass-bg);
      border-radius: 20px;
      border: 1px solid var(--glass-border);
      backdrop-filter: blur(25px) saturate(180%);
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
      display: flex;
      flex-direction: column;
      overflow: hidden;
      transform: translateY(20px) scale(0.95);
      opacity: 0;
      visibility: hidden;
      transition: var(--transition-bounce);
      z-index: 100;
    }

    .chat-container.mostrar {
      transform: translateY(0) scale(1);
      opacity: 1;
      visibility: visible;
      animation: subtlePulse 0.6s ease;
    }

    .chat-container.expandido {
      width: 480px;
      height: 650px;
      animation: expandBounce 0.4s ease-out;
    }

    @keyframes subtlePulse {
      0%, 100% { transform: translateY(0) scale(1); }
      50% { transform: translateY(0) scale(1.02); }
    }

    @keyframes expandBounce {
      0% { transform: scale(1); }
      50% { transform: scale(1.02); }
      100% { transform: scale(1); }
    }

    /* Chat Header mejorado */
    .chat-header {
      padding: 20px;
      background: rgba(0, 0, 0, 0.4);
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid var(--glass-border);
      backdrop-filter: blur(10px);
    }

    .chat-status {
      display: flex;
      align-items: center;
      gap: 10px;
      font-weight: 600;
      letter-spacing: 0.5px;
    }

    .ai-indicator {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: var(--success-color);
      position: relative;
      animation: aiPulse 2s infinite;
    }

    .ai-indicator::after {
      content: '';
      position: absolute;
      top: -2px;
      left: -2px;
      width: 16px;
      height: 16px;
      border-radius: 50%;
      background: var(--success-color);
      opacity: 0.3;
      animation: aiRipple 2s infinite;
    }

    @keyframes aiPulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }

    @keyframes aiRipple {
      0% { transform: scale(0.8); opacity: 0.3; }
      100% { transform: scale(1.4); opacity: 0; }
    }

    .expand-chat {
      background: rgba(255, 255, 255, 0.1);
      border: none;
      color: var(--text-light);
      font-size: 18px;
      cursor: pointer;
      padding: 8px;
      border-radius: 8px;
      transition: var(--transition-smooth);
      backdrop-filter: blur(5px);
      position: relative;
      overflow: hidden;
    }

    .expand-chat:hover {
      background: rgba(255, 255, 255, 0.2);
      transform: scale(1.1);
    }

    .expand-chat::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 5px;
      height: 5px;
      background: rgba(255, 255, 255, 0.2);
      opacity: 0;
      border-radius: 100%;
      transform: scale(1, 1) translate(-50%, -50%);
      transform-origin: 50% 50%;
    }

    .expand-chat:focus:not(:active)::after {
      animation: ripple 1s ease-out;
    }

    @keyframes ripple {
      0% {
        transform: scale(0, 0);
        opacity: 0.5;
      }
      100% {
        transform: scale(20, 20);
        opacity: 0;
      }
    }

    .expand-chat .expand-icon, .expand-chat .minimize-icon {
      transition: opacity 0.3s ease, transform 0.3s ease;
    }

    .expand-chat .minimize-icon {
      position: absolute;
      opacity: 0;
      transform: rotate(-90deg);
    }

    .chat-container.expandido .expand-chat .expand-icon {
      opacity: 0;
      transform: rotate(90deg);
    }

    .chat-container.expandido .expand-chat .minimize-icon {
      opacity: 1;
      transform: rotate(0deg);
    }

    /* Chat Messages mejorado */
    .chat-messages {
      flex: 1;
      padding: 20px;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: 15px;
      scroll-behavior: smooth;
      scrollbar-width: thin;
      scrollbar-color: var(--primary-color) rgba(255, 255, 255, 0.05);
    }

    .chat-messages::-webkit-scrollbar {
      width: 6px;
    }

    .chat-messages::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 10px;
    }

    .chat-messages::-webkit-scrollbar-thumb {
      background: linear-gradient(135deg, var(--primary-color), #ff4757);
      border-radius: 10px;
    }

    .chat-messages::-webkit-scrollbar-thumb:hover {
      background: linear-gradient(135deg, #ff4757, var(--primary-color));
    }

    .message-divider {
      border: none;
      height: 1px;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
      margin: 12px 0;
    }

    /* Mensajes mejorados */
    .bot-message, .user-message {
      max-width: 85%;
      padding: 15px 20px;
      border-radius: 20px;
      position: relative;
      animation: messageSlideIn 0.4s ease-out;
      word-wrap: break-word;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      backdrop-filter: blur(10px);
      line-height: 1.5;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .bot-message:hover, .user-message:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
    }

    @keyframes messageSlideIn {
      from { opacity: 0; transform: translateY(15px) scale(0.95); }
      to { opacity: 1; transform: translateY(0) scale(1); }
    }

    .bot-message {
      align-self: flex-start;
      background: linear-gradient(135deg, rgba(13, 71, 161, 0.4), rgba(13, 71, 161, 0.2));
      border-bottom-left-radius: 8px;
      border-left: 4px solid var(--secondary-color);
    }

    .user-message {
      align-self: flex-end;
      background: linear-gradient(135deg, rgba(212, 21, 40, 0.4), rgba(212, 21, 40, 0.2));
      border-bottom-right-radius: 8px;
      border-right: 4px solid var(--primary-color);
    }

    .bot-message.welcome {
      background: linear-gradient(135deg, rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.3));
      border: 1px solid var(--glass-border);
      border-left: 4px solid var(--accent-color);
      max-width: 100%;
    }

    @keyframes messageHighlight {
      0% { background-color: rgba(255, 255, 255, 0.1); }
      100% { background-color: transparent; }
    }

    .bot-message:last-of-type, .user-message:last-of-type {
      animation: messageHighlight 1s ease;
    }

    /* Indicador de escritura mejorado */
    .typing-indicator {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 15px 20px;
      background: rgba(0, 0, 0, 0.4);
      border-radius: 20px;
      border-bottom-left-radius: 8px;
      align-self: flex-start;
      margin-bottom: 10px;
      backdrop-filter: blur(10px);
      animation: typingSlideIn 0.3s ease-out;
    }

    @keyframes typingSlideIn {
      from { opacity: 0; transform: translateX(-10px); }
      to { opacity: 1; transform: translateX(0); }
    }

    .typing-indicator span {
      width: 8px;
      height: 8px;
      background: var(--text-light);
      border-radius: 50%;
      display: inline-block;
      animation: typingBounce 1.4s infinite ease-in-out;
      will-change: transform;
    }

    .typing-indicator span:nth-child(1) { animation-delay: 0s; }
    .typing-indicator span:nth-child(2) { animation-delay: 0.2s; }
    .typing-indicator span:nth-child(3) { animation-delay: 0.4s; }

    @keyframes typingBounce {
      0%, 60%, 100% { transform: translateY(0) scale(1); }
      30% { transform: translateY(-8px) scale(1.1); }
    }

    /* Acciones r√°pidas mejoradas */
    .quick-actions {
      display: flex;
      justify-content: space-around;
      padding: 15px;
      background: rgba(0, 0, 0, 0.3);
      border-top: 1px solid var(--glass-border);
      gap: 8px;
      flex-wrap: wrap;
    }

    .quick-btn {
      background: rgba(255, 255, 255, 0.1);
      border: none;
      color: var(--text-light);
      padding: 10px 14px;
      border-radius: 25px;
      cursor: pointer;
      font-size: 12px;
      font-weight: 500;
      transition: var(--transition-smooth);
      white-space: nowrap;
      backdrop-filter: blur(5px);
      border: 1px solid rgba(255, 255, 255, 0.05);
    }

    .quick-btn:hover {
      background: rgba(255, 255, 255, 0.2);
      transform: translateY(-2px) scale(1.05);
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    }

    /* Formulario de chat mejorado */
    .chat-input-form {
      display: flex;
      padding: 20px;
      background: rgba(0, 0, 0, 0.4);
      border-top: 1px solid var(--glass-border);
      gap: 12px;
      align-items: center;
    }

    #chat-input {
      flex: 1;
      padding: 12px 20px;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 25px;
      color: var(--text-light);
      outline: none;
      font-size: 14px;
      transition: all 0.3s ease, box-shadow 0.3s ease;
      backdrop-filter: blur(5px);
    }

    #chat-input:focus {
      background: rgba(255, 255, 255, 0.15);
      border-color: var(--primary-color);
      box-shadow: 0 0 0 2px rgba(212, 21, 40, 0.3);
    }

    #chat-input::placeholder {
      color: rgba(255, 255, 255, 0.5);
    }

    #send-btn {
      background: linear-gradient(135deg, var(--primary-color), #ff4757);
      color: white;
      border: none;
      border-radius: 25px;
      padding: 12px 20px;
      cursor: pointer;
      font-weight: 600;
      transition: var(--transition-smooth);
      box-shadow: 0 4px 15px rgba(212, 21, 40, 0.3);
      min-width: 80px;
      position: relative;
      overflow: hidden;
      z-index: 1;
    }

    #send-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #ff4757, var(--primary-color));
      opacity: 0;
      z-index: -1;
      transition: opacity 0.3s ease;
    }

    #send-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(212, 21, 40, 0.4);
    }

    #send-btn:hover::before {
      opacity: 1;
    }

    #send-btn:active {
      transform: translateY(0);
    }

    /* Metrics Overlay mejorado */
    .metrics-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 200;
      opacity: 0;
      visibility: hidden;
      transition: var(--transition-smooth);
      backdrop-filter: blur(10px);
    }

    .metrics-overlay.active {
      opacity: 1;
      visibility: visible;
    }

    .metrics-panel {
      background: var(--bg-dark);
      border-radius: 20px;
      padding: 30px;
      width: 85%;
      max-width: 650px;
      max-height: 80vh;
      overflow-y: auto;
      border: 1px solid var(--glass-border);
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
      animation: metricsSlideIn 0.4s ease-out;
    }

    @keyframes metricsSlideIn {
      from { opacity: 0; transform: scale(0.9) translateY(20px); }
      to { opacity: 1; transform: scale(1) translateY(0); }
    }

    .metrics-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-top: 25px;
    }

    .metric-card {
      background: rgba(0, 0, 0, 0.4);
      padding: 20px;
      border-radius: 15px;
      border-left: 4px solid var(--primary-color);
      transition: var(--transition-smooth);
      backdrop-filter: blur(10px);
    }

    .metric-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
    }

    .metric-card h3 {
      font-size: 14px;
      margin-bottom: 15px;
      color: rgba(255, 255, 255, 0.7);
      font-weight: 500;
      letter-spacing: 0.5px;
    }

    .metric-card p {
      font-size: 28px;
      font-weight: 700;
      color: var(--text-light);
    }

    .close-metrics {
      background: linear-gradient(135deg, var(--primary-color), #ff4757);
      color: white;
      border: none;
      padding: 12px 25px;
      border-radius: 10px;
      cursor: pointer;
      margin-top: 25px;
      width: 100%;
      font-weight: 600;
      transition: var(--transition-smooth);
      font-size: 16px;
    }

    .close-metrics:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(212, 21, 40, 0.4);
    }

    /* Sistema de notificaciones mejorado */
    #notifications-container {
      position: fixed;
      top: 100px;
      right: 20px;
      display: flex;
      flex-direction: column;
      gap: 12px;
      z-index: 150;
      max-width: 350px;
    }

    .notification {
      background: var(--glass-bg);
      backdrop-filter: blur(20px);
      padding: 15px 20px;
      border-radius: 12px;
      border-left: 4px solid var(--success-color);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
      animation: notificationSlideIn 0.4s ease-out;
      display: flex;
      align-items: center;
      gap: 12px;
      transition: var(--transition-smooth);
    }

    .notification:hover {
      transform: translateX(-5px);
      box-shadow: 0 12px 40px rgba(0, 0, 0, 0.4);
    }

    .notification.error { border-left-color: var(--error-color); }
    .notification.warning { border-left-color: var(--warning-color); }
    .notification.info { border-left-color: var(--secondary-color); }

    @keyframes notificationSlideIn {
      from { transform: translateX(100%) scale(0.9); opacity: 0; }
      to { transform: translateX(0) scale(1); opacity: 1; }
    }

    /* Part√≠culas mejoradas */
    .particles {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 1;
    }

    .particle {
      position: absolute;
      width: 2px;
      height: 2px;
      background: rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      animation: particleFloat 20s infinite linear;
    }

    @keyframes particleFloat {
      0% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
      10% { opacity: 1; }
      90% { opacity: 1; }
      100% { transform: translateY(-100vh) rotate(360deg); opacity: 0; }
    }

    /* Modo emergencia mejorado */
    .emergency-mode {
      animation: emergencyPulse 1s infinite;
    }

    @keyframes emergencyPulse {
      0% { box-shadow: 0 0 0 0 rgba(213, 0, 0, 0.7); }
      70% { box-shadow: 0 0 0 15px rgba(213, 0, 0, 0); }
      100% { box-shadow: 0 0 0 0 rgba(213, 0, 0, 0); }
    }

    /* Tipos de mensajes especiales */
    .message-emergency {
      background: rgba(213, 0, 0, 0.3) !important;
      border-left: 4px solid var(--error-color);
    }

    .message-warning {
      background: rgba(255, 109, 0, 0.3) !important;
      border-left: 4px solid var(--warning-color);
    }

    .message-success {
      background: rgba(0, 200, 83, 0.3) !important;
      border-left: 4px solid var(--success-color);
    }

    .message-system {
      background: rgba(255, 255, 255, 0.1) !important;
      border-left: 4px solid var(--text-light);
    }

    .message-ai {
      background: rgba(255, 171, 0, 0.3) !important;
      border-left: 4px solid var(--accent-color);
    }

    /* Dise√±o responsivo mejorado */
    @media (max-width: 768px) {
      .chat-container {
        width: calc(100% - 20px);
        height: 75vh;
        right: 10px;
        bottom: 10px;
        border-radius: 15px;
      }
      
      .chat-container.expandido {
        width: calc(100% - 20px);
        height: 85vh;
      }
      
      .chat-bubble {
        width: 55px;
        height: 55px;
        bottom: 20px;
        right: 20px;
        font-size: 22px;
      }
      
      .welcome-screen h1 {
        font-size: 2.5rem;
      }
      
      .welcome-screen p {
        font-size: 1rem;
      }
      
      .metrics-panel {
        width: 95%;
        padding: 20px;
      }
      
      .metrics-grid {
        grid-template-columns: 1fr;
        gap: 15px;
      }

      .quick-actions {
        flex-wrap: wrap;
        gap: 6px;
      }

      .quick-btn {
        font-size: 11px;
        padding: 8px 12px;
      }

      .logo {
        width: 60px;
        height: 60px;
        font-size: 20px;
      }

      .system-status {
        padding: 10px 12px;
        font-size: 12px;
      }

      #notifications-container {
        right: 10px;
        top: 90px;
        max-width: calc(100% - 20px);
      }
      
      .chat-input-form {
        padding: 15px;
      }
      
      #chat-input {
        padding: 10px 15px;
      }
      
      #send-btn {
        padding: 10px 15px;
        min-width: auto;
      }
    }

    @media (max-width: 480px) {
      .chat-container {
        width: calc(100% - 10px);
        height: 80vh;
        right: 5px;
        bottom: 5px;
      }
      
      .chat-header {
        padding: 15px;
      }
      
      .chat-messages {
        padding: 15px;
      }
      
      .welcome-screen h1 {
        font-size: 2rem;
      }
      
      /* Asegurar que el input no se tape en m√≥viles */
      .chat-container {
        max-height: 70vh;
      }
      
      .chat-messages {
        padding-bottom: 15px;
      }
    }

    /* Soporte para tablets */
    @media (min-width: 769px) and (max-width: 1024px) {
      .chat-container {
        width: 350px;
        height: 500px;
      }
      
      .chat-container.expandido {
        width: 450px;
        height: 600px;
      }
    }

    /* Mejoras de accesibilidad */
    @media (prefers-reduced-motion: reduce) {
      * {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
    }

    @media (prefers-contrast: high) {
      .chat-container {
        background: var(--bg-dark) !important;
        border: 2px solid var(--text-light) !important;
      }
      
      .bot-message, .user-message {
        background: var(--bg-darker) !important;
      }
      
      #chat-input {
        background: var(--bg-darker) !important;
        border: 2px solid var(--text-light) !important;
      }
    }

    /* Indicador de foco mejorado */
    button:focus-visible, input:focus-visible {
      outline: 2px solid var(--accent-color) !important;
      outline-offset: 2px;
    }

    /* Efecto de ne√≥n para el estado */
    @keyframes neonGlow {
      0%, 100% { text-shadow: 0 0 5px var(--success-color), 0 0 10px var(--success-color); }
      50% { text-shadow: 0 0 10px var(--success-color), 0 0 20px var(--success-color); }
    }

    .status-indicator.online {
      animation: neonGlow 2s infinite alternate;
    }

    /* Transiciones para el expand/minimize */
    .chat-container {
      will-change: transform, width, height;
    }
  </style>
</head>
<body>
  <!-- Video de fondo -->
  <video autoplay muted loop id="bg-video">
    <source src="/static/background.mp4" type="video/mp4" />
    <!-- Fallback para navegadores que no soporten el video -->
    <div class="video-fallback"></div>
  </video>

  <!-- Overlay con efectos -->
  <div class="overlay"></div>

  <!-- Part√≠culas flotantes -->
  <div class="particles" id="particles"></div>

  <!-- Logo mejorado -->
  <div class="logo">C</div>

  <!-- Indicador de estado del sistema -->
  <div class="system-status">
    <div class="status-indicator" id="status-indicator"></div>
    <span id="status-text">Sistema Operativo</span>
  </div>

  <!-- Pantalla de bienvenida -->
  <div class="welcome-screen">
    <h1>Asesor Claro</h1>
    <p>Asistente IA avanzado para plataformas Core</p>
    <div class="sparkle" style="top: 20%; left: 30%;"></div>
    <div class="sparkle" style="top: 60%; right: 20%;"></div>
    <div class="sparkle" style="top: 40%; right: 40%;"></div>
  </div>

  <!-- Notificaciones -->
  <div id="notifications-container"></div>

  <!-- Burbuja de chat -->
  <div class="chat-bubble" id="chat-bubble">
    <span>üí¨</span>
  </div>

  <!-- Contenedor de chat avanzado -->
  <div class="chat-container" id="chat-container">
    <div class="chat-header">
      <div class="chat-status">
        <div class="ai-indicator" id="ai-indicator"></div>
        <span>Asesor IA Claro</span>
      </div>
      <button class="expand-chat" id="expand-chat">
        <span class="expand-icon">‚§¢</span>
        <span class="minimize-icon">‚§°</span>
      </button>
    </div>

    <div class="chat-messages" id="chat-messages">
      <!-- Los mensajes se cargar√°n din√°micamente aqu√≠ -->
    </div>

    <div class="quick-actions">
      <button class="quick-btn" onclick="sendQuickAction('estado sistema')">üìä Estado</button>
      <button class="quick-btn" onclick="sendQuickAction('emergencia')">üö® Emergencia</button>
      <button class="quick-btn" onclick="sendQuickAction('dashboard')">üìà Dashboard</button>
      <button class="quick-btn" onclick="sendQuickAction('alarmas')">‚ö†Ô∏è Alarmas</button>
    </div>

    <form class="chat-input-form" id="chat-form">
      <input type="text" id="chat-input" placeholder="Escribe tu mensaje o comando..." autocomplete="off" />
      <button type="submit" id="send-btn">Enviar</button>
    </form>
  </div>

  <!-- Panel de m√©tricas -->
  <div class="metrics-overlay" id="metrics-overlay">
    <div class="metrics-panel">
      <h2>üìä M√©tricas del Sistema</h2>
      <div class="metrics-grid" id="metrics-content">
        <!-- Las m√©tricas se cargar√°n aqu√≠ -->
      </div>
      <button class="close-metrics" onclick="closeMetrics()">Cerrar</button>
    </div>
  </div>

  <script>
    // Crear part√≠culas
    function createParticles() {
      const particlesContainer = document.getElementById('particles');
      for (let i = 0; i < 50; i++) {
        const particle = document.createElement('div');
        particle.className = 'particle';
        particle.style.left = Math.random() * 100 + '%';
        particle.style.animationDelay = Math.random() * 20 + 's';
        particle.style.animationDuration = (Math.random() * 10 + 10) + 's';
        particlesContainer.appendChild(particle);
      }
    }

    // Variables globales
    let chatVisible = false;
    let expandido = false;
    let inactivityTimer;
    let lastActivity = Date.now();
    let currentState = '';
    let alarmNumber = '';

    // Inicializar
    document.addEventListener('DOMContentLoaded', function() {
      createParticles();
      setupEventListeners();
      showWelcomeMessage();
    });

    // Configurar event listeners
    function setupEventListeners() {
      const chatBubble = document.getElementById('chat-bubble');
      const chatContainer = document.getElementById('chat-container');
      const expandBtn = document.getElementById('expand-chat');
      const chatForm = document.getElementById('chat-form');
      const chatInput = document.getElementById('chat-input');

      chatBubble.addEventListener('click', toggleChat);
      expandBtn.addEventListener('click', toggleExpand);
      chatForm.addEventListener('submit', handleSubmit);
      
      // Cerrar chat al hacer clic fuera
      document.addEventListener('click', function(e) {
        if (!chatContainer.contains(e.target) && !chatBubble.contains(e.target)) {
          if (chatVisible) {
            closeChat();
          }
        }
      });

      // Actividad del usuario
      document.addEventListener('mousemove', updateActivity);
      document.addEventListener('keypress', updateActivity);
    }

    // Mostrar mensaje de bienvenida
    function showWelcomeMessage() {
      setTimeout(() => {
        if (!chatVisible) {
          showNotification('Buen d√≠a, hablemos de nuestras plataformas de Core', 'info');
        }
      }, 2000);
    }

    // Toggle chat
    function toggleChat() {
      const chatContainer = document.getElementById('chat-container');
      chatVisible = !chatVisible;
      
      if (chatVisible) {
        chatContainer.classList.add('mostrar');
        document.getElementById('chat-input').focus();
        
        // Mostrar saludo inicial
        setTimeout(() => {
          addMessage('¬°Hola! Soy tu Asesor IA Claro. ¬øEn qu√© puedo ayudarte hoy?', 'bot', 'welcome');
          setTimeout(() => {
            showInitialMenu();
          }, 3000);
        }, 500);
      } else {
        chatContainer.classList.remove('mostrar');
      }
    }

    // Cerrar chat
    function closeChat() {
      const chatContainer = document.getElementById('chat-container');
      chatContainer.classList.remove('mostrar');
      chatVisible = false;
    }

    // Toggle expandir
    function toggleExpand() {
      const chatContainer = document.getElementById('chat-container');
      expandido = !expandido;
      
      if (expandido) {
        chatContainer.classList.add('expandido');
      } else {
        chatContainer.classList.remove('expandido');
      }
    }

    // Mostrar men√∫ inicial
    function showInitialMenu() {
      const menuMessage = `
        <div style="text-align: left; padding: 10px;">
          <p><strong>Buen d√≠a, hablemos de nuestras plataformas de Core.</strong></p>
          <p>¬øQu√© te gustar√≠a consultar el d√≠a de hoy?</p>
          <hr style="margin: 10px 0; border-color: rgba(255,255,255,0.2);">
          <p>1Ô∏è‚É£ Alarmas de plataformas</p>
          <p>2Ô∏è‚É£ Documentaci√≥n de las plataformas</p>
          <p>3Ô∏è‚É£ Incidentes activos de las plataformas</p>
          <p>4Ô∏è‚É£ Estado operativo de las plataformas</p>
          <p>5Ô∏è‚É£ Cambios activos en las plataformas</p>
          <p>6Ô∏è‚É£ Hablar con el administrador de la plataforma</p>
          <hr style="margin: 10px 0; border-color: rgba(255,255,255,0.2);">
          <p><em>Por favor selecciona una opci√≥n num√©rica</em></p>
        </div>
      `;
      addMessage(menuMessage, 'bot', 'system');
    }

    // Manejar env√≠o de mensaje
    function handleSubmit(e) {
      e.preventDefault();
      const input = document.getElementById('chat-input');
      const message = input.value.trim();
      
      if (message) {
        addMessage(message, 'user');
        input.value = '';
        
        // Simular respuesta del bot
        setTimeout(() => {
          handleBotResponse(message);
        }, 1000);
      }
    }

    // Manejar respuesta del bot
    function handleBotResponse(userMessage) {
      const msg = userMessage.toLowerCase();
      let response = '';
      let messageType = 'bot';
      
      if (msg.includes('1') || msg.includes('alarma')) {
        response = 'Por favor ingrese el n√∫mero de alarma que desea consultar';
        messageType = 'system';
        currentState = 'awaiting_alarm_number';
      } else if (msg.includes('2') || msg.includes('documentaci√≥n')) {
        response = 'Documentaci√≥n disponible:\n\n‚Ä¢ Manual de usuario\n‚Ä¢ Gu√≠as t√©cnicas\n‚Ä¢ Protocolos de operaci√≥n\n\n¬øQu√© documentaci√≥n espec√≠fica necesitas?';
        messageType = 'bot';
      } else if (msg.includes('3') || msg.includes('incidente')) {
        response = 'Incidentes activos actualmente:\n\n1. INC-2023-0456 - Latencia en plataforma Core\n2. INC-2023-0457 - Problema de sincronizaci√≥n\n\n¬øNecesitas detalles de alg√∫n incidente en particular?';
        messageType = 'warning';
      } else if (msg.includes('4') || msg.includes('estado operativo')) {
        response = 'Estado operativo actual:\n\n‚Ä¢ Plataforma Core A: Operativa\n‚Ä¢ Plataforma Core B: En mantenimiento\n‚Ä¢ Plataforma Core C: Operativa con alertas\n\n¬øNecesitas m√°s detalles?';
        messageType = 'success';
      } else if (msg.includes('5') || msg.includes('cambio')) {
        response = 'Cambios programados:\n\n‚Ä¢ CHG-2023-0789 - Actualizaci√≥n de firmware (hoy 20:00)\n‚Ä¢ CHG-2023-0790 - Migraci√≥n de datos (ma√±ana 02:00)\n\n¬øQuieres m√°s informaci√≥n sobre alg√∫n cambio?';
        messageType = 'ai';
      } else if (msg.includes('6') || msg.includes('administrador')) {
        response = 'Conectando con el administrador de plataforma...\n\nPor favor describe brevemente el motivo de tu consulta para asignarla al especialista adecuado.';
        messageType = 'system';
      } else if (currentState === 'awaiting_alarm_number') {
        response = 'Por favor ingresa el nombre del elemento que reporta la alarma';
        currentState = 'awaiting_element_name';
        alarmNumber = msg; // Guardamos el n√∫mero de alarma
      } else if (currentState === 'awaiting_element_name') {
        response = `Consulta de alarma completada:\n\n‚Ä¢ N√∫mero de alarma: ${alarmNumber}\n‚Ä¢ Elemento: ${msg}\n\nDetalles:\nLa alarma fue generada por el elemento mencionado. Se ha registrado un ticket de seguimiento.`;
        currentState = '';
        messageType = 'warning';
      } else if (msg.includes('menu')) {
        showInitialMenu();
        return;
      } else if (msg.includes('limpiar')) {
        clearChat();
        return;
      } else {
        response = 'No he entendido tu solicitud. Por favor selecciona una opci√≥n del men√∫ o escribe "menu" para ver las opciones disponibles.';
        messageType = 'system';
      }
      
      showTyping();
      setTimeout(() => {
        hideTyping();
        addMessage(response, 'bot', messageType);
      }, 1500);
    }

    // Mostrar indicador de escritura
    function showTyping() {
      const typingDiv = document.createElement('div');
      typingDiv.className = 'typing-indicator';
      typingDiv.id = 'typing-indicator';
      typingDiv.innerHTML = '<span></span><span></span><span></span>';
      
      document.getElementById('chat-messages').appendChild(typingDiv);
      scrollToBottom();
    }

    // Ocultar indicador de escritura
    function hideTyping() {
      const typingIndicator = document.getElementById('typing-indicator');
      if (typingIndicator) {
        typingIndicator.remove();
      }
    }

    // Agregar mensaje
    function addMessage(message, sender, type = '') {
      const messagesContainer = document.getElementById('chat-messages');
      const messageDiv = document.createElement('div');
      
      let className = sender === 'user' ? 'user-message' : 'bot-message';
      if (type) {
        className += ' ' + type;
        if (type === 'emergency') className += ' message-emergency';
        if (type === 'warning') className += ' message-warning';
        if (type === 'success') className += ' message-success';
        if (type === 'system') className += ' message-system';
        if (type === 'ai') className += ' message-ai';
      }
      
      messageDiv.className = className;
      messageDiv.innerHTML = message.replace(/\n/g, '<br>');
      
      messagesContainer.appendChild(messageDiv);
      scrollToBottom();
    }

    // Scroll al final
    function scrollToBottom() {
      const messagesContainer = document.getElementById('chat-messages');
      messagesContainer.scrollTop = messagesContainer.scrollHeight;
    }

    // Limpiar chat
    function clearChat() {
      const messagesContainer = document.getElementById('chat-messages');
      messagesContainer.innerHTML = '';
      addMessage('Chat limpiado. ¬øEn qu√© puedo ayudarte?', 'bot', 'system');
    }

    // Acciones r√°pidas
    function sendQuickAction(action) {
      document.getElementById('chat-input').value = action;
      document.getElementById('chat-form').dispatchEvent(new Event('submit'));
    }

    // Mostrar notificaci√≥n
    function showNotification(message, type = 'info') {
      const container = document.getElementById('notifications-container');
      const notification = document.createElement('div');
      notification.className = `notification ${type}`;
      notification.innerHTML = `
        <span>${getNotificationIcon(type)}</span>
        <span>${message}</span>
      `;
      
      container.appendChild(notification);
      
      setTimeout(() => {
        notification.style.animation = 'notificationSlideIn 0.3s ease reverse';
        setTimeout(() => {
          notification.remove();
        }, 300);
      }, 4000);
    }

    // Obtener icono de notificaci√≥n
    function getNotificationIcon(type) {
      switch(type) {
        case 'error': return '‚ùå';
        case 'warning': return '‚ö†Ô∏è';
        case 'success': return '‚úÖ';
        default: return '‚ÑπÔ∏è';
      }
    }

    // Mostrar m√©tricas
    function showMetrics() {
      const metricsOverlay = document.getElementById('metrics-overlay');
      const metricsContent = document.getElementById('metrics-content');
      
      metricsContent.innerHTML = `
        <div class="metric-card">
          <h3>Consultas Hoy</h3>
          <p>1,247</p>
        </div>
        <div class="metric-card">
          <h3>Tiempo Respuesta</h3>
          <p>45ms</p>
        </div>
        <div class="metric-card">
          <h3>Uptime</h3>
          <p>99.8%</p>
        </div>
        <div class="metric-card">
          <h3>Satisfacci√≥n</h3>
          <p>94%</p>
        </div>
        <div class="metric-card">
          <h3>Usuarios Activos</h3>
          <p>234</p>
        </div>
        <div class="metric-card">
          <h3>Alarmas Cr√≠ticas</h3>
          <p>3</p>
        </div>
      `;
      
      metricsOverlay.classList.add('active');
    }

    // Cerrar m√©tricas
    function closeMetrics() {
      document.getElementById('metrics-overlay').classList.remove('active');
    }

    // Actualizar actividad
    function updateActivity() {
      lastActivity = Date.now();
      clearTimeout(inactivityTimer);
      
      inactivityTimer = setTimeout(() => {
        if (chatVisible) {
          addMessage('¬øSigues ah√≠? ¬øNecesitas ayuda con algo m√°s?', 'bot', 'system');
        }
      }, 300000); // 5 minutos
    }

    // Cambiar estado del sistema
    function updateSystemStatus(status, text) {
      const indicator = document.getElementById('status-indicator');
      const statusText = document.getElementById('status-text');
      
      indicator.className = 'status-indicator';
      
      switch(status) {
        case 'online':
          indicator.style.background = 'var(--success-color)';
          break;
        case 'warning':
          indicator.style.background = 'var(--warning-color)';
          break;
        case 'error':
          indicator.style.background = 'var(--error-color)';
          break;
        case 'maintenance':
          indicator.style.background = 'var(--secondary-color)';
          break;
      }
      
      statusText.textContent = text;
    }

    // Simular cambios de estado
    setInterval(() => {
      const statuses = [
        { status: 'online', text: 'Sistema Operativo' },
        { status: 'warning', text: 'Alerta Menor' },
        { status: 'online', text: 'Funcionando Normal' }
      ];
      
      const randomStatus = statuses[Math.floor(Math.random() * statuses.length)];
      updateSystemStatus(randomStatus.status, randomStatus.text);
    }, 30000);

    // Efectos de teclado
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape' && chatVisible) {
        closeChat();
      }
      
      if (e.key === 'Enter' && e.ctrlKey && chatVisible) {
        toggleExpand();
      }
    });

    // Detecci√≥n de modo emergencia
    function activateEmergencyMode() {
      document.body.classList.add('emergency-mode');
      updateSystemStatus('error', 'MODO EMERGENCIA');
      showNotification('¬°MODO EMERGENCIA ACTIVADO!', 'error');
      
      setTimeout(() => {
        document.body.classList.remove('emergency-mode');
        updateSystemStatus('online', 'Sistema Operativo');
      }, 10000);
    }

    // Comandos de voz (experimental)
    if ('webkitSpeechRecognition' in window) {
      const recognition = new webkitSpeechRecognition();
      recognition.continuous = false;
      recognition.interimResults = false;
      recognition.lang = 'es-ES';

      recognition.onresult = function(event) {
        const transcript = event.results[0][0].transcript;
        document.getElementById('chat-input').value = transcript;
        showNotification('Comando de voz detectado: ' + transcript, 'info');
      };
    }
  </script>
</body>
</html>